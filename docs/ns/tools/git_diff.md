 :: type: NSproject
 :: subtype: tool_specification
 :: version: 0.1.0
 :: id: tool-spec-git-diff-v0.1
 :: status: draft
 :: dependsOn: [docs/ns/tools/tool_spec_structure.md](./tool_spec_structure.md), [pkg/core/tools_git.go](../../pkg/core/tools_git.go), [pkg/core/tools_git_register.go](../../pkg/core/tools_git_register.go)
 :: howToUpdate: Update if arguments, return value, or behavior changes (e.g., adding options for cached diff, specific files, etc.).

 # Tool Specification: TOOL.GitDiff (v0.1)

 * **Tool Name:** TOOL.GitDiff (v0.1)
 * **Purpose:** Shows differences between files in the working directory and the Git index (staging area). Useful for reviewing changes before staging them.
 * **NeuroScript Syntax:**
   ```neuroscript
   diffOutput := TOOL.GitDiff()
   ```
 * **Arguments:**
    * None. This version executes a plain `git diff`, showing changes in tracked files in the working directory that have not yet been staged.
 * **Return Value:** (String)
    * If changes are detected: A string containing the standard diff output generated by the `git diff` command.
    * If no changes are detected: A string indicating "GitDiff: No changes detected in the working tree."
    * On failure: An error (e.g., not executed within a Git repository). The error message will typically contain the standard error output from the `git diff` command.
 * **Behavior:**
    1. Executes the `git diff` command within the designated sandbox environment.
    2. The underlying `git diff` command compares the state of tracked files in the working directory against their state in the Git index (staging area).
    3. If differences exist, the command prints them to standard output in patch format. The tool captures and returns this output.
    4. If no differences exist between the working directory and the index, the command produces no output. The tool detects this and returns a specific message indicating no changes.
    5. If `git diff` encounters a fatal error (e.g., the directory is not a Git repository), the tool returns an error wrapping the standard error output from the Git command.
 * **Security Considerations:**
    * Executes an external process (`git`). Ensure the execution environment is secure.
    * Reads file content within the sandbox directory to generate the diff. Relies on filesystem permissions.
 * **Examples:**
   ```neuroscript
   // Show unstaged changes in the working directory
   currentDiff := TOOL.GitDiff()
   IO.Print("Current Working Directory Diff:")
   IO.Print(currentDiff)

   // Example check if there are changes
   diffResult := TOOL.GitDiff()
   IF diffResult != "GitDiff: No changes detected in the working tree." THEN
       IO.Print("Unstaged changes detected.")
   ELSE
       IO.Print("Working tree is clean (no unstaged changes).")
   END
   ```
 * **Go Implementation Notes:**
    * Implemented in `pkg/core/tools_git.go` as `toolGitDiff`.
    * Uses the `toolExec` helper function to run the `git diff` command.
    * Registered in `pkg/core/tools_git_register.go`.
    * Checks if the output from `toolExec` is empty to return the "no changes" message, as `git diff` normally exits successfully with status 0 even when there are differences (it only outputs them).