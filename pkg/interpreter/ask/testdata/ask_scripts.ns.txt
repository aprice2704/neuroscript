// NeuroScript Version: 0.6.0
// File version: 1.0.0
// Purpose: Contains NeuroScript procedures for testing the 'ask' statement.
// filename: pkg/interpreter/ask/testdata/ask_scripts.ns.txt
// nlines: 50

func TestBasicSuccess(returns result) means
    ask "default_agent", "What is the capital of BC?" into result
    return result
endfunc

func TestWithOptions() means
    set opts = { "temperature": 0.85 }
    ask "default_agent", "Be creative" with opts
endfunc

func TestProviderError(returns string) means
    set status = "initial"
    on error do
        set status = "caught provider error"
        clear_error
    endon
    
    ask "default_agent", "This will fail"
    
    if status == "initial"
        set status = "error was not caught"
    endif

    return status
endfunc

func TestNonExistentAgent(returns string) means
    set status = "initial"
    on error do
        set err_msg = system_error_message
        set check = tool.str.Contains(err_msg, "is not registered")
        if check
            set status = "correct error caught"
        else
            set status = "wrong error caught: " + err_msg
        endif
        clear_error
    endon
    
    ask "unregistered_agent", "This will fail"

    if status == "initial"
        set status = "error was not caught"
    endif

    return status
endfunc