// NeuroScript Version: 0.7.0
// File version: 6
// Purpose: Corrected to use the modern 'ask' statement, which now handles envelope creation internally.
// filename: livetest/test_scripts/agentic.txt
// nlines: 15
// risk_rating: LOW

func main(needs subject, goal_text returns result) means
    # Assemble the userdata payload as a JSON string. The 'ask' statement
    # is smart enough to use this directly as the USERDATA section content
    # without needing to be wrapped in a full envelope first.
    set userdata_json = '{"subject":"' + subject + '","goal":"' + goal_text + '"}'

    # The modern 'ask' statement handles all envelope creation. We simply pass
    # it the content for the USERDATA section.
    ask "live_agent", userdata_json into result

    return result
endfunc